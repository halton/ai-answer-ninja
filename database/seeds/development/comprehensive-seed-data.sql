-- AI Answer Ninja - Comprehensive Development Seed Data
-- Realistic test data for development and testing environments

-- ===========================================
-- Development Environment Safety Check
-- ===========================================

DO $$
BEGIN
    -- Only allow in development/test environments
    IF current_database() NOT LIKE '%dev%' 
       AND current_database() NOT LIKE '%test%' 
       AND current_database() != 'ai_ninja_development' THEN
        RAISE EXCEPTION 'Seed data can only be loaded in development/test databases. Current: %', current_database();
    END IF;
    
    RAISE NOTICE 'Loading seed data into development database: %', current_database();
END $$;

-- ===========================================
-- Clear Existing Data (Development Only)
-- ===========================================

-- Disable foreign key checks temporarily
SET session_replication_role = replica;

-- Clear tables in dependency order
TRUNCATE TABLE user_spam_interactions CASCADE;
TRUNCATE TABLE conversations CASCADE;
TRUNCATE TABLE call_records CASCADE;
TRUNCATE TABLE smart_whitelists CASCADE;
TRUNCATE TABLE user_configs CASCADE;
TRUNCATE TABLE global_configs CASCADE;
TRUNCATE TABLE spam_profiles CASCADE;
TRUNCATE TABLE users CASCADE;

-- Re-enable foreign key checks
SET session_replication_role = DEFAULT;

-- ===========================================
-- Global Configuration Data
-- ===========================================

INSERT INTO global_configs (config_key, config_value, config_type, description, is_active) VALUES
    ('ai.response_timeout_ms', '5000', 'system', 'AI response generation timeout in milliseconds', true),
    ('ai.cache_enabled', 'true', 'feature', 'Enable AI response caching', true),
    ('ai.max_response_length', '200', 'system', 'Maximum AI response length in characters', true),
    ('ai.default_language', 'zh-CN', 'system', 'Default language for AI responses', true),
    
    ('call.max_duration_seconds', '300', 'system', 'Maximum call duration in seconds', true),
    ('call.recording_enabled', 'true', 'feature', 'Enable call recording', true),
    ('call.analytics_enabled', 'true', 'feature', 'Enable call analytics', true),
    
    ('security.max_failed_attempts', '5', 'security', 'Maximum failed login attempts', true),
    ('security.lockout_duration_minutes', '15', 'security', 'Account lockout duration', true),
    ('security.session_timeout_minutes', '60', 'security', 'User session timeout', true),
    
    ('performance.cache_ttl_seconds', '3600', 'system', 'Default cache TTL', true),
    ('performance.rate_limit_per_minute', '100', 'system', 'Default rate limit per minute', true),
    
    ('whitelist.auto_learning_enabled', 'true', 'feature', 'Enable automatic whitelist learning', true),
    ('whitelist.confidence_threshold', '0.8', 'system', 'Minimum confidence for auto-whitelist', true),
    
    ('monitoring.health_check_interval', '300', 'system', 'Health check interval in seconds', true),
    ('monitoring.metrics_retention_days', '30', 'system', 'Metrics retention period', true);

-- ===========================================\n-- Sample Users\n-- ===========================================\n\nINSERT INTO users (id, phone_number, name, personality, voice_profile_id, language_preference, timezone, max_call_duration, preferences) VALUES\n    ('550e8400-e29b-41d4-a716-446655440001', '+86-139-1234-5678', '张明', 'polite', 'voice_profile_001', 'zh-CN', 'Asia/Shanghai', 300, \n     '{\"ai_response_speed\": \"normal\", \"call_screening_level\": \"medium\", \"block_unknown_numbers\": false, \"custom_greetings\": true}'),\n     \n    ('550e8400-e29b-41d4-a716-446655440002', '+86-138-8765-4321', '李华', 'direct', 'voice_profile_002', 'zh-CN', 'Asia/Shanghai', 180,\n     '{\"ai_response_speed\": \"fast\", \"call_screening_level\": \"high\", \"block_unknown_numbers\": true, \"custom_greetings\": false}'),\n     \n    ('550e8400-e29b-41d4-a716-446655440003', '+86-135-9876-5432', '王丽', 'humorous', 'voice_profile_003', 'zh-CN', 'Asia/Shanghai', 240,\n     '{\"ai_response_speed\": \"normal\", \"call_screening_level\": \"low\", \"block_unknown_numbers\": false, \"custom_greetings\": true}'),\n     \n    ('550e8400-e29b-41d4-a716-446655440004', '+1-555-123-4567', 'John Smith', 'professional', 'voice_profile_004', 'en-US', 'America/New_York', 300,\n     '{\"ai_response_speed\": \"normal\", \"call_screening_level\": \"medium\", \"block_unknown_numbers\": false, \"custom_greetings\": true}'),\n     \n    ('550e8400-e29b-41d4-a716-446655440005', '+44-20-7946-0958', 'Emma Johnson', 'polite', 'voice_profile_005', 'en-GB', 'Europe/London', 300,\n     '{\"ai_response_speed\": \"slow\", \"call_screening_level\": \"high\", \"block_unknown_numbers\": true, \"custom_greetings\": false}');\n\n-- ===========================================\n-- User-specific Configurations\n-- ===========================================\n\nINSERT INTO user_configs (user_id, config_key, config_value, inherits_global, auto_learned, learning_confidence) VALUES\n    -- Zhang Ming's custom settings\n    ('550e8400-e29b-41d4-a716-446655440001', 'ai.response_style', '\"礼貌而友好\"', false, false, null),\n    ('550e8400-e29b-41d4-a716-446655440001', 'ai.greeting_message', '\"您好，我现在不方便接听电话，请留言\"', false, false, null),\n    ('550e8400-e29b-41d4-a716-446655440001', 'whitelist.auto_add_family', 'true', false, true, 0.95),\n    \n    -- Li Hua's custom settings (direct personality)\n    ('550e8400-e29b-41d4-a716-446655440002', 'ai.response_style', '\"直接明了\"', false, false, null),\n    ('550e8400-e29b-41d4-a716-446655440002', 'ai.greeting_message', '\"我不接陌生电话\"', false, false, null),\n    ('550e8400-e29b-41d4-a716-446655440002', 'call.auto_reject_sales', 'true', false, true, 0.85),\n    \n    -- Wang Li's custom settings (humorous personality)\n    ('550e8400-e29b-41d4-a716-446655440003', 'ai.response_style', '\"幽默轻松\"', false, false, null),\n    ('550e8400-e29b-41d4-a716-446655440003', 'ai.greeting_message', '\"我在忙着拯救世界，请稍后再试\"', false, false, null),\n    \n    -- John's English settings\n    ('550e8400-e29b-41d4-a716-446655440004', 'ai.response_style', '\"professional and courteous\"', false, false, null),\n    ('550e8400-e29b-41d4-a716-446655440004', 'ai.greeting_message', '\"I\\'m currently unavailable. Please leave a message.\"', false, false, null),\n    \n    -- Emma's British English settings\n    ('550e8400-e29b-41d4-a716-446655440005', 'ai.response_style', '\"polite and reserved\"', false, false, null),\n    ('550e8400-e29b-41d4-a716-446655440005', 'ai.greeting_message', '\"I\\'m terribly sorry, but I\\'m not available at the moment.\"', false, false, null);\n\n-- ===========================================\n-- Spam Profiles (Realistic Spammer Data)\n-- ===========================================\n\nINSERT INTO spam_profiles (id, phone_hash, spam_category, risk_score, confidence_level, total_reports, successful_blocks, false_positive_count, feature_vector, behavioral_patterns, first_reported, last_activity) VALUES\n    ('660e8400-e29b-41d4-a716-446655440001', \n     ENCODE(SHA256('+86-400-123-9999'::bytea), 'hex'), \n     'sales', 0.85, 0.92, 15, 12, 1,\n     '{\"call_frequency\": 3.2, \"call_duration_avg\": 45, \"voice_keywords\": [\"产品\", \"优惠\", \"活动\"], \"persistence_level\": 0.7}',\n     '{\"typical_call_times\": [\"09:00-11:00\", \"14:00-17:00\"], \"common_scripts\": [\"产品推广\", \"优惠活动\"], \"success_rate\": 0.15}',\n     CURRENT_TIMESTAMP - INTERVAL '30 days', CURRENT_TIMESTAMP - INTERVAL '2 days'),\n     \n    ('660e8400-e29b-41d4-a716-446655440002',\n     ENCODE(SHA256('+86-400-888-8888'::bytea), 'hex'),\n     'loan', 0.92, 0.95, 25, 23, 0,\n     '{\"call_frequency\": 5.1, \"call_duration_avg\": 35, \"voice_keywords\": [\"贷款\", \"利息\", \"额度\"], \"persistence_level\": 0.9}',\n     '{\"typical_call_times\": [\"10:00-12:00\", \"13:00-18:00\"], \"common_scripts\": [\"低息贷款\", \"快速放款\"], \"success_rate\": 0.08}',\n     CURRENT_TIMESTAMP - INTERVAL '45 days', CURRENT_TIMESTAMP - INTERVAL '1 day'),\n     \n    ('660e8400-e29b-41d4-a716-446655440003',\n     ENCODE(SHA256('+86-021-5555-1234'::bytea), 'hex'),\n     'investment', 0.78, 0.88, 8, 6, 2,\n     '{\"call_frequency\": 2.8, \"call_duration_avg\": 60, \"voice_keywords\": [\"投资\", \"理财\", \"收益\"], \"persistence_level\": 0.6}',\n     '{\"typical_call_times\": [\"09:30-11:30\", \"14:30-16:30\"], \"common_scripts\": [\"理财产品\", \"投资机会\"], \"success_rate\": 0.25}',\n     CURRENT_TIMESTAMP - INTERVAL '20 days', CURRENT_TIMESTAMP - INTERVAL '3 days'),\n     \n    ('660e8400-e29b-41d4-a716-446655440004',\n     ENCODE(SHA256('+86-010-8888-9999'::bytea), 'hex'),\n     'insurance', 0.73, 0.85, 12, 9, 1,\n     '{\"call_frequency\": 2.5, \"call_duration_avg\": 55, \"voice_keywords\": [\"保险\", \"保障\", \"理赔\"], \"persistence_level\": 0.5}',\n     '{\"typical_call_times\": [\"08:30-11:00\", \"14:00-17:30\"], \"common_scripts\": [\"保险产品\", \"保障方案\"], \"success_rate\": 0.30}',\n     CURRENT_TIMESTAMP - INTERVAL '15 days', CURRENT_TIMESTAMP - INTERVAL '5 days'),\n     \n    ('660e8400-e29b-41d4-a716-446655440005',\n     ENCODE(SHA256('+1-800-SCAMMER'::bytea), 'hex'),\n     'scam', 0.95, 0.98, 50, 48, 0,\n     '{\"call_frequency\": 8.2, \"call_duration_avg\": 25, \"voice_keywords\": [\"urgent\", \"verify\", \"account\"], \"persistence_level\": 0.95}',\n     '{\"typical_call_times\": [\"all_day\"], \"common_scripts\": [\"account_verification\", \"urgent_action\"], \"success_rate\": 0.02}',\n     CURRENT_TIMESTAMP - INTERVAL '60 days', CURRENT_TIMESTAMP - INTERVAL '6 hours');\n\n-- ===========================================\n-- Smart Whitelists\n-- ===========================================\n\nINSERT INTO smart_whitelists (id, user_id, contact_phone, contact_name, whitelist_type, confidence_score, is_active, hit_count, last_hit_at) VALUES\n    -- Zhang Ming's whitelist\n    (gen_random_uuid(), '550e8400-e29b-41d4-a716-446655440001', '+86-139-8888-1111', '妈妈', 'manual', 1.0, true, 25, CURRENT_TIMESTAMP - INTERVAL '1 hour'),\n    (gen_random_uuid(), '550e8400-e29b-41d4-a716-446655440001', '+86-138-7777-2222', '老婆', 'manual', 1.0, true, 42, CURRENT_TIMESTAMP - INTERVAL '3 hours'),\n    (gen_random_uuid(), '550e8400-e29b-41d4-a716-446655440001', '+86-135-6666-3333', '老板', 'auto', 0.95, true, 8, CURRENT_TIMESTAMP - INTERVAL '2 days'),\n    (gen_random_uuid(), '550e8400-e29b-41d4-a716-446655440001', '+86-136-5555-4444', '快递员', 'learned', 0.85, true, 15, CURRENT_TIMESTAMP - INTERVAL '1 day'),\n    \n    -- Li Hua's whitelist (more selective)\n    (gen_random_uuid(), '550e8400-e29b-41d4-a716-446655440002', '+86-138-9999-5555', '家人', 'manual', 1.0, true, 18, CURRENT_TIMESTAMP - INTERVAL '30 minutes'),\n    (gen_random_uuid(), '550e8400-e29b-41d4-a716-446655440002', '+86-139-8888-6666', '同事', 'manual', 1.0, true, 6, CURRENT_TIMESTAMP - INTERVAL '1 week'),\n    \n    -- Wang Li's whitelist (more open)\n    (gen_random_uuid(), '550e8400-e29b-41d4-a716-446655440003', '+86-135-7777-7777', '朋友小王', 'manual', 1.0, true, 12, CURRENT_TIMESTAMP - INTERVAL '2 hours'),\n    (gen_random_uuid(), '550e8400-e29b-41d4-a716-446655440003', '+86-136-6666-8888', '医生', 'auto', 0.90, true, 3, CURRENT_TIMESTAMP - INTERVAL '1 week'),\n    (gen_random_uuid(), '550e8400-e29b-41d4-a716-446655440003', '+86-137-5555-9999', '银行客服', 'learned', 0.88, true, 7, CURRENT_TIMESTAMP - INTERVAL '3 days'),\n    \n    -- John's whitelist\n    (gen_random_uuid(), '550e8400-e29b-41d4-a716-446655440004', '+1-555-987-6543', 'Mom', 'manual', 1.0, true, 20, CURRENT_TIMESTAMP - INTERVAL '4 hours'),\n    (gen_random_uuid(), '550e8400-e29b-41d4-a716-446655440004', '+1-555-876-5432', 'Office', 'manual', 1.0, true, 15, CURRENT_TIMESTAMP - INTERVAL '1 day'),\n    (gen_random_uuid(), '550e8400-e29b-41d4-a716-446655440004', '+1-555-765-4321', 'Doctor', 'auto', 0.92, true, 2, CURRENT_TIMESTAMP - INTERVAL '2 weeks'),\n    \n    -- Emma's whitelist\n    (gen_random_uuid(), '550e8400-e29b-41d4-a716-446655440005', '+44-20-7946-0001', 'Mum', 'manual', 1.0, true, 35, CURRENT_TIMESTAMP - INTERVAL '2 hours'),\n    (gen_random_uuid(), '550e8400-e29b-41d4-a716-446655440005', '+44-20-7946-0002', 'Work', 'manual', 1.0, true, 12, CURRENT_TIMESTAMP - INTERVAL '6 hours'),\n    (gen_random_uuid(), '550e8400-e29b-41d4-a716-446655440005', '+44-20-7946-0003', 'GP Surgery', 'learned', 0.87, true, 4, CURRENT_TIMESTAMP - INTERVAL '1 month');\n\n-- ===========================================\n-- Call Records (Recent Activity)\n-- ===========================================\n\nINSERT INTO call_records (id, user_id, caller_phone, call_type, call_status, start_time, end_time, duration_seconds, azure_call_id, response_time_ms, cache_hit_ratio, ai_model_version, processing_metadata) VALUES\n    -- Successful AI-handled spam calls\n    (gen_random_uuid(), '550e8400-e29b-41d4-a716-446655440001', '+86-400-123-9999', 'incoming', 'completed', \n     CURRENT_TIMESTAMP - INTERVAL '2 hours', CURRENT_TIMESTAMP - INTERVAL '2 hours' + INTERVAL '45 seconds', \n     45, 'azure-call-001', 650, 0.85, 'gpt-4-turbo', \n     '{\"spam_detected\": true, \"confidence\": 0.92, \"response_type\": \"polite_decline\", \"user_satisfaction\": \"good\"}'),\n     \n    (gen_random_uuid(), '550e8400-e29b-41d4-a716-446655440002', '+86-400-888-8888', 'incoming', 'completed',\n     CURRENT_TIMESTAMP - INTERVAL '1 day', CURRENT_TIMESTAMP - INTERVAL '1 day' + INTERVAL '25 seconds',\n     25, 'azure-call-002', 580, 0.92, 'gpt-4-turbo',\n     '{\"spam_detected\": true, \"confidence\": 0.95, \"response_type\": \"direct_rejection\", \"user_satisfaction\": \"excellent\"}'),\n     \n    -- Whitelisted calls (transferred)\n    (gen_random_uuid(), '550e8400-e29b-41d4-a716-446655440001', '+86-139-8888-1111', 'incoming', 'completed',\n     CURRENT_TIMESTAMP - INTERVAL '1 hour', CURRENT_TIMESTAMP - INTERVAL '1 hour' + INTERVAL '5 minutes',\n     300, 'azure-call-003', 120, 1.0, 'gpt-4-turbo',\n     '{\"whitelist_hit\": true, \"transferred\": true, \"response_type\": \"immediate_transfer\", \"user_satisfaction\": \"excellent\"}'),\n     \n    (gen_random_uuid(), '550e8400-e29b-41d4-a716-446655440004', '+1-555-987-6543', 'incoming', 'completed',\n     CURRENT_TIMESTAMP - INTERVAL '4 hours', CURRENT_TIMESTAMP - INTERVAL '4 hours' + INTERVAL '8 minutes',\n     480, 'azure-call-004', 95, 1.0, 'gpt-4-turbo',\n     '{\"whitelist_hit\": true, \"transferred\": true, \"response_type\": \"immediate_transfer\", \"user_satisfaction\": \"excellent\"}'),\n     \n    -- Unknown number with AI conversation\n    (gen_random_uuid(), '550e8400-e29b-41d4-a716-446655440003', '+86-155-1234-5678', 'incoming', 'completed',\n     CURRENT_TIMESTAMP - INTERVAL '6 hours', CURRENT_TIMESTAMP - INTERVAL '6 hours' + INTERVAL '2 minutes',\n     120, 'azure-call-005', 750, 0.78, 'gpt-4-turbo',\n     '{\"spam_detected\": false, \"confidence\": 0.45, \"response_type\": \"inquiry_screening\", \"user_satisfaction\": \"good\"}'),\n     \n    -- Failed call (technical issue)\n    (gen_random_uuid(), '550e8400-e29b-41d4-a716-446655440005', '+44-800-SPAM-CALL', 'incoming', 'failed',\n     CURRENT_TIMESTAMP - INTERVAL '12 hours', CURRENT_TIMESTAMP - INTERVAL '12 hours' + INTERVAL '10 seconds',\n     10, 'azure-call-006', null, null, 'gpt-4-turbo',\n     '{\"error\": \"azure_timeout\", \"retry_attempted\": true, \"failure_reason\": \"network_connectivity\"}'),\n     \n    -- Recent high-volume spam attack\n    (gen_random_uuid(), '550e8400-e29b-41d4-a716-446655440001', '+86-400-ROBOCALL', 'incoming', 'completed',\n     CURRENT_TIMESTAMP - INTERVAL '30 minutes', CURRENT_TIMESTAMP - INTERVAL '30 minutes' + INTERVAL '15 seconds',\n     15, 'azure-call-007', 420, 0.95, 'gpt-4-turbo',\n     '{\"spam_detected\": true, \"confidence\": 0.98, \"response_type\": \"quick_rejection\", \"robocall_detected\": true}'),\n     \n    (gen_random_uuid(), '550e8400-e29b-41d4-a716-446655440002', '+86-400-ROBOCALL', 'incoming', 'completed',\n     CURRENT_TIMESTAMP - INTERVAL '25 minutes', CURRENT_TIMESTAMP - INTERVAL '25 minutes' + INTERVAL '8 seconds',\n     8, 'azure-call-008', 380, 0.98, 'gpt-4-turbo',\n     '{\"spam_detected\": true, \"confidence\": 0.99, \"response_type\": \"immediate_hangup\", \"robocall_detected\": true}');\n\n-- ===========================================\n-- Conversation Records\n-- ===========================================\n\nINSERT INTO conversations (id, call_record_id, sequence_number, speaker, message_text, timestamp, confidence_score, intent_category, emotion, processing_latency, message_length, has_keywords, is_spam_indicator) VALUES\n    -- Conversation 1: Spam sales call handled politely\n    (gen_random_uuid(), \n     (SELECT id FROM call_records WHERE azure_call_id = 'azure-call-001'),\n     1, 'caller', '你好，我是XX公司的，想给您介绍一个很好的产品', \n     CURRENT_TIMESTAMP - INTERVAL '2 hours', 0.95, 'sales_introduction', 'neutral', 150, 25, true, true),\n     \n    (gen_random_uuid(),\n     (SELECT id FROM call_records WHERE azure_call_id = 'azure-call-001'),\n     2, 'ai', '您好，感谢您的来电。不过我现在不太方便，也暂时不需要了解新产品。谢谢您的理解。',\n     CURRENT_TIMESTAMP - INTERVAL '2 hours' + INTERVAL '3 seconds', 0.92, 'polite_decline', 'polite', 650, 42, false, false),\n     \n    (gen_random_uuid(),\n     (SELECT id FROM call_records WHERE azure_call_id = 'azure-call-001'),\n     3, 'caller', '这个产品真的很优惠，您可以先了解一下',\n     CURRENT_TIMESTAMP - INTERVAL '2 hours' + INTERVAL '6 seconds', 0.88, 'sales_persistence', 'persistent', 120, 22, true, true),\n     \n    (gen_random_uuid(),\n     (SELECT id FROM call_records WHERE azure_call_id = 'azure-call-001'),\n     4, 'ai', '我理解您的工作，但是我真的不需要。祝您工作顺利，再见。',\n     CURRENT_TIMESTAMP - INTERVAL '2 hours' + INTERVAL '8 seconds', 0.90, 'final_decline', 'firm', 480, 30, false, false),\n     \n    -- Conversation 2: Direct rejection\n    (gen_random_uuid(),\n     (SELECT id FROM call_records WHERE azure_call_id = 'azure-call-002'),\n     1, 'caller', '您好，我们这里有低息贷款业务',\n     CURRENT_TIMESTAMP - INTERVAL '1 day', 0.96, 'loan_offer', 'neutral', 110, 15, true, true),\n     \n    (gen_random_uuid(),\n     (SELECT id FROM call_records WHERE azure_call_id = 'azure-call-002'),\n     2, 'ai', '不需要，再见。',\n     CURRENT_TIMESTAMP - INTERVAL '1 day' + INTERVAL '2 seconds', 0.98, 'direct_rejection', 'direct', 580, 7, false, false),\n     \n    -- Conversation 3: Unknown caller screening\n    (gen_random_uuid(),\n     (SELECT id FROM call_records WHERE azure_call_id = 'azure-call-005'),\n     1, 'caller', '请问是王丽女士吗？',\n     CURRENT_TIMESTAMP - INTERVAL '6 hours', 0.85, 'identity_verification', 'neutral', 200, 9, false, false),\n     \n    (gen_random_uuid(),\n     (SELECT id FROM call_records WHERE azure_call_id = 'azure-call-005'),\n     2, 'ai', '请问您是哪位？找我有什么事吗？',\n     CURRENT_TIMESTAMP - INTERVAL '6 hours' + INTERVAL '3 seconds', 0.88, 'caller_inquiry', 'cautious', 750, 15, false, false),\n     \n    (gen_random_uuid(),\n     (SELECT id FROM call_records WHERE azure_call_id = 'azure-call-005'),\n     3, 'caller', '我是您朋友小张介绍的，想和您聊聊投资的事',\n     CURRENT_TIMESTAMP - INTERVAL '6 hours' + INTERVAL '8 seconds', 0.82, 'referral_claim', 'friendly', 180, 21, true, true),\n     \n    (gen_random_uuid(),\n     (SELECT id FROM call_records WHERE azure_call_id = 'azure-call-005'),\n     4, 'ai', '不好意思，我不认识什么小张，也不感兴趣投资。如果没有其他事就先这样吧。',\n     CURRENT_TIMESTAMP - INTERVAL '6 hours' + INTERVAL '12 seconds', 0.90, 'suspicious_rejection', 'suspicious', 620, 35, false, false);\n\n-- ===========================================\n-- User-Spam Interaction History\n-- ===========================================\n\nINSERT INTO user_spam_interactions (id, user_id, spam_profile_id, interaction_count, block_count, allow_count, user_feedback, feedback_confidence, ai_accuracy_score, response_effectiveness, first_interaction, last_interaction, last_feedback_at) VALUES\n    -- Zhang Ming's interactions\n    (gen_random_uuid(), '550e8400-e29b-41d4-a716-446655440001', '660e8400-e29b-41d4-a716-446655440001', \n     3, 3, 0, 'spam', 0.95, 0.92, 0.88, \n     CURRENT_TIMESTAMP - INTERVAL '30 days', CURRENT_TIMESTAMP - INTERVAL '2 hours', CURRENT_TIMESTAMP - INTERVAL '2 hours'),\n     \n    (gen_random_uuid(), '550e8400-e29b-41d4-a716-446655440001', '660e8400-e29b-41d4-a716-446655440003',\n     1, 1, 0, 'spam', 0.90, 0.88, 0.85,\n     CURRENT_TIMESTAMP - INTERVAL '20 days', CURRENT_TIMESTAMP - INTERVAL '20 days', CURRENT_TIMESTAMP - INTERVAL '20 days'),\n     \n    -- Li Hua's interactions (more aggressive blocking)\n    (gen_random_uuid(), '550e8400-e29b-41d4-a716-446655440002', '660e8400-e29b-41d4-a716-446655440002',\n     2, 2, 0, 'spam', 0.98, 0.95, 0.92,\n     CURRENT_TIMESTAMP - INTERVAL '45 days', CURRENT_TIMESTAMP - INTERVAL '1 day', CURRENT_TIMESTAMP - INTERVAL '1 day'),\n     \n    (gen_random_uuid(), '550e8400-e29b-41d4-a716-446655440002', '660e8400-e29b-41d4-a716-446655440005',\n     1, 1, 0, 'spam', 1.0, 0.98, 0.95,\n     CURRENT_TIMESTAMP - INTERVAL '60 days', CURRENT_TIMESTAMP - INTERVAL '25 minutes', CURRENT_TIMESTAMP - INTERVAL '25 minutes'),\n     \n    -- Wang Li's interactions (some false positives)\n    (gen_random_uuid(), '550e8400-e29b-41d4-a716-446655440003', '660e8400-e29b-41d4-a716-446655440004',\n     2, 1, 1, 'not_spam', 0.85, 0.85, 0.60,\n     CURRENT_TIMESTAMP - INTERVAL '15 days', CURRENT_TIMESTAMP - INTERVAL '15 days', CURRENT_TIMESTAMP - INTERVAL '15 days'),\n     \n    -- John's interactions\n    (gen_random_uuid(), '550e8400-e29b-41d4-a716-446655440004', '660e8400-e29b-41d4-a716-446655440005',\n     1, 1, 0, 'spam', 0.95, 0.98, 0.90,\n     CURRENT_TIMESTAMP - INTERVAL '30 days', CURRENT_TIMESTAMP - INTERVAL '30 days', CURRENT_TIMESTAMP - INTERVAL '30 days');\n\n-- ===========================================\n-- Update Statistics and Materialized Views\n-- ===========================================\n\n-- Update table statistics for query planning\nANALYZE users;\nANALYZE smart_whitelists;\nANALYZE call_records;\nANALYZE conversations;\nANALYZE spam_profiles;\nANALYZE user_spam_interactions;\nANALYZE global_configs;\nANALYZE user_configs;\n\n-- Refresh materialized views if they exist\nDO $$\nBEGIN\n    -- Only refresh if materialized views exist\n    IF EXISTS (SELECT 1 FROM pg_matviews WHERE matviewname = 'mv_call_analytics_summary') THEN\n        REFRESH MATERIALIZED VIEW mv_call_analytics_summary;\n    END IF;\n    \n    IF EXISTS (SELECT 1 FROM pg_matviews WHERE matviewname = 'mv_conversation_intelligence') THEN\n        REFRESH MATERIALIZED VIEW mv_conversation_intelligence;\n    END IF;\n    \n    IF EXISTS (SELECT 1 FROM pg_matviews WHERE matviewname = 'mv_spam_trend_analysis') THEN\n        REFRESH MATERIALIZED VIEW mv_spam_trend_analysis;\n    END IF;\n    \n    IF EXISTS (SELECT 1 FROM pg_matviews WHERE matviewname = 'mv_user_behavior_analysis') THEN\n        REFRESH MATERIALIZED VIEW mv_user_behavior_analysis;\n    END IF;\nEXCEPTION\n    WHEN OTHERS THEN\n        RAISE NOTICE 'Some materialized views could not be refreshed: %', SQLERRM;\nEND $$;\n\n-- ===========================================\n-- Verification and Summary\n-- ===========================================\n\n-- Verify data integrity\nDO $$\nDECLARE\n    v_user_count INTEGER;\n    v_call_count INTEGER;\n    v_conversation_count INTEGER;\n    v_whitelist_count INTEGER;\n    v_spam_profile_count INTEGER;\nBEGIN\n    SELECT COUNT(*) INTO v_user_count FROM users;\n    SELECT COUNT(*) INTO v_call_count FROM call_records;\n    SELECT COUNT(*) INTO v_conversation_count FROM conversations;\n    SELECT COUNT(*) INTO v_whitelist_count FROM smart_whitelists;\n    SELECT COUNT(*) INTO v_spam_profile_count FROM spam_profiles;\n    \n    RAISE NOTICE '=========================================';\n    RAISE NOTICE 'Seed Data Loading Summary';\n    RAISE NOTICE '=========================================';\n    RAISE NOTICE 'Users loaded: %', v_user_count;\n    RAISE NOTICE 'Call records loaded: %', v_call_count;\n    RAISE NOTICE 'Conversations loaded: %', v_conversation_count;\n    RAISE NOTICE 'Whitelist entries loaded: %', v_whitelist_count;\n    RAISE NOTICE 'Spam profiles loaded: %', v_spam_profile_count;\n    RAISE NOTICE '=========================================';\n    \n    -- Validate foreign key relationships\n    IF EXISTS (\n        SELECT 1 FROM call_records cr \n        LEFT JOIN users u ON cr.user_id = u.id \n        WHERE u.id IS NULL\n    ) THEN\n        RAISE EXCEPTION 'Data integrity error: Orphaned call records found';\n    END IF;\n    \n    IF EXISTS (\n        SELECT 1 FROM conversations c \n        LEFT JOIN call_records cr ON c.call_record_id = cr.id \n        WHERE cr.id IS NULL\n    ) THEN\n        RAISE EXCEPTION 'Data integrity error: Orphaned conversations found';\n    END IF;\n    \n    RAISE NOTICE 'Data integrity checks passed!';\n    RAISE NOTICE 'Seed data loading completed successfully!';\nEND $$;\n\n-- Create development-specific indexes for testing\nCREATE INDEX IF NOT EXISTS idx_dev_call_records_recent \nON call_records(start_time DESC) \nWHERE start_time > CURRENT_TIMESTAMP - INTERVAL '7 days';\n\nCREATE INDEX IF NOT EXISTS idx_dev_conversations_recent \nON conversations(timestamp DESC) \nWHERE timestamp > CURRENT_TIMESTAMP - INTERVAL '7 days';\n\n-- Set up development-specific monitoring\nINSERT INTO global_configs (config_key, config_value, config_type, description, is_active) VALUES\n    ('dev.seed_data_loaded', 'true', 'system', 'Indicates seed data has been loaded', true),\n    ('dev.seed_data_version', '1.0', 'system', 'Version of loaded seed data', true),\n    ('dev.seed_data_timestamp', extract(epoch from now())::text, 'system', 'Timestamp when seed data was loaded', true)\nON CONFLICT (config_key) DO UPDATE SET \n    config_value = EXCLUDED.config_value,\n    updated_at = CURRENT_TIMESTAMP;\n\nRAISE NOTICE 'Development seed data loading completed!';\nRAISE NOTICE 'You can now test the AI Answer Ninja system with realistic data.';