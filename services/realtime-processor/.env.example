# Real-time Processor Service Configuration
# Copy this file to .env and configure for your environment

# Server Configuration
NODE_ENV=development
PORT=3002
HOST=0.0.0.0
MAX_CONNECTIONS=1000
CONNECTION_TIMEOUT=30000
KEEP_ALIVE_TIMEOUT=30000

# Redis Configuration
REDIS_URL=redis://localhost:6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_MAX_RETRIES=3
REDIS_RETRY_DELAY=1000
REDIS_CONNECT_TIMEOUT=5000

# Azure Speech Services Configuration
AZURE_SPEECH_KEY=your_azure_speech_key_here
AZURE_SPEECH_REGION=eastus2
AZURE_SPEECH_ENDPOINT=https://eastus2.api.cognitive.microsoft.com/
AZURE_SPEECH_LANGUAGE=zh-CN
AZURE_SPEECH_OUTPUT_FORMAT=audio-16khz-32kbitrate-mono-mp3

# Azure OpenAI Configuration
AZURE_OPENAI_KEY=your_azure_openai_key_here
AZURE_OPENAI_ENDPOINT=https://your-resource.openai.azure.com/
AZURE_OPENAI_DEPLOYMENT_NAME=gpt-4
AZURE_OPENAI_API_VERSION=2024-02-15-preview
AZURE_OPENAI_MAX_TOKENS=150
AZURE_OPENAI_TEMPERATURE=0.7

# Performance Configuration
AUDIO_CHUNK_SIZE=1024
MAX_AUDIO_DURATION=180000
PROCESSING_TIMEOUT=5000
MAX_CONCURRENT_PROCESSING=10
CACHE_SIZE=1000
COMPRESSION_ENABLED=true

# Security Configuration
JWT_SECRET=your_super_secret_jwt_key_change_in_production
ALLOWED_ORIGINS=localhost:3000,localhost:3001
RATE_LIMIT_WINDOW=60000
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_MAX_CONNECTIONS=10
RATE_LIMIT_SKIP_SUCCESS=true
ENCRYPTION_ENABLED=true
ENCRYPTION_ALGORITHM=aes-256-gcm
ENCRYPTION_KEY_SIZE=32

# Monitoring Configuration
METRICS_ENABLED=true
METRICS_INTERVAL=5000
HEALTH_CHECK_INTERVAL=5000
LOG_LEVEL=info
PERFORMANCE_MONITORING=true

# Cache Configuration
CACHE_ENABLED=true
CACHE_TTL_STT_RESULTS=3600
CACHE_TTL_INTENT_RESULTS=1800
CACHE_TTL_AI_RESPONSES=900
CACHE_TTL_TTS_AUDIO=7200
CACHE_TTL_USER_PROFILES=86400
CACHE_MAX_SIZE_STT=1000
CACHE_MAX_SIZE_INTENT=2000
CACHE_MAX_SIZE_AI=500
CACHE_MAX_SIZE_TTS=100
CACHE_MAX_SIZE_PROFILES=10000
CACHE_COMPRESSION_ENABLED=true
CACHE_PRELOADING_ENABLED=true

# Circuit Breaker Configuration
CIRCUIT_BREAKER_ENABLED=true
CIRCUIT_BREAKER_FAILURE_THRESHOLD=5
CIRCUIT_BREAKER_RESET_TIMEOUT=60000
CIRCUIT_BREAKER_TIMEOUT=30000
CIRCUIT_BREAKER_VOLUME_THRESHOLD=10
CIRCUIT_BREAKER_ERROR_THRESHOLD=50

# Performance Optimization Targets (milliseconds)
TARGET_TOTAL_PIPELINE_LATENCY=800
TARGET_AUDIO_PREPROCESSING=50
TARGET_SPEECH_TO_TEXT=200
TARGET_INTENT_RECOGNITION=100
TARGET_AI_GENERATION=300
TARGET_TEXT_TO_SPEECH=150

# Alert Thresholds
ALERT_THRESHOLD_LATENCY=1000
ALERT_THRESHOLD_CPU_USAGE=80
ALERT_THRESHOLD_MEMORY_USAGE=85
ALERT_THRESHOLD_ERROR_RATE=5

# Development and Debug
DEBUG_MODE=false
VERBOSE_LOGGING=false
ENABLE_REQUEST_LOGGING=true
ENABLE_PERFORMANCE_PROFILING=true
ENABLE_METRICS_EXPORT=true

# Production Optimizations
CLUSTER_MODE=false
CLUSTER_WORKERS=0
GRACEFUL_SHUTDOWN_TIMEOUT=10000
HEALTH_CHECK_GRACE_PERIOD=5000

# External Services
CONVERSATION_ENGINE_URL=http://localhost:3003
USER_MANAGEMENT_URL=http://localhost:3005
SMART_WHITELIST_URL=http://localhost:3006

# Feature Flags
ENABLE_ADVANCED_VAD=true
ENABLE_NOISE_REDUCTION=true
ENABLE_VOICE_CLONING=false
ENABLE_EMOTION_DETECTION=true
ENABLE_REAL_TIME_TRANSCRIPTION=true
ENABLE_PREDICTIVE_CACHING=true
ENABLE_AUTO_OPTIMIZATION=true

# Database Configuration (if needed for direct DB access)
DATABASE_URL=postgresql://username:password@localhost:5432/ai_answer_ninja
DATABASE_POOL_SIZE=10
DATABASE_CONNECTION_TIMEOUT=5000

# Monitoring and Observability
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090
JAEGER_ENABLED=false
JAEGER_ENDPOINT=http://localhost:14268/api/traces
ELASTIC_APM_ENABLED=false
ELASTIC_APM_SERVER_URL=http://localhost:8200

# File Storage (for audio caching)
STORAGE_TYPE=local
STORAGE_PATH=./storage/audio
AWS_S3_BUCKET=
AWS_S3_REGION=
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=

# WebSocket Configuration
WS_MAX_PAYLOAD=10485760
WS_COMPRESSION=true
WS_PING_INTERVAL=30000
WS_PONG_TIMEOUT=5000
WS_MAX_CONNECTIONS_PER_IP=5

# Audio Processing Configuration
AUDIO_SAMPLE_RATE=16000
AUDIO_CHANNELS=1
AUDIO_BIT_DEPTH=16
AUDIO_FORMAT=pcm
VAD_SENSITIVITY=0.5
VAD_AGGRESSIVENESS=2
NOISE_REDUCTION_LEVEL=0.3
AUDIO_NORMALIZATION=true

# AI Configuration
AI_RESPONSE_MAX_LENGTH=200
AI_CONTEXT_WINDOW=4000
AI_USE_SYSTEM_PROMPT=true
AI_TEMPERATURE=0.7
AI_TOP_P=0.9
AI_FREQUENCY_PENALTY=0.1
AI_PRESENCE_PENALTY=0.1

# Voice Configuration
DEFAULT_VOICE=zh-CN-XiaoxiaoNeural
VOICE_SPEED=1.0
VOICE_PITCH=0
VOICE_VOLUME=100
ENABLE_SSML=true

# Rate Limiting (Advanced)
RATE_LIMIT_STRATEGY=sliding_window
RATE_LIMIT_REDIS_KEY_PREFIX=rl:
RATE_LIMIT_SKIP_FAILED_REQUESTS=false
RATE_LIMIT_SKIP_SUCCESSFUL_REQUESTS=false

# Error Handling
MAX_RETRY_ATTEMPTS=3
RETRY_DELAY_BASE=1000
RETRY_DELAY_MAX=10000
CIRCUIT_BREAKER_ENABLED=true
BULKHEAD_ENABLED=true
TIMEOUT_ENABLED=true

# Development Tools
HOT_RELOAD=true
SOURCE_MAPS=true
PROFILING_ENABLED=false
MEMORY_LEAK_DETECTION=false
PERFORMANCE_HOOKS=false